<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS AI | ENTERPRISE V15.2 SUPPORT</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --bg: #05070a; --card: #0f121a; --vip: #ffcc00; --win: #00ff80; --loss: #ff3e3e; --pink: #ff00ff; --admin: #ff4500; --wa: #25d366; --tg: #0088cc; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; margin: 0; padding: 10px; text-align: center; }
        .card { background: var(--card); border: 1px solid #1a1e26; border-radius: 15px; padding: 20px; margin-bottom: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; }
        h1, h3 { font-family: 'Orbitron', sans-serif; margin: 15px 0; }
        .btn-prime { width: 100%; padding: 15px; border-radius: 12px; border: none; background: linear-gradient(45deg, #7000ff, var(--neon)); color: white; font-weight: bold; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        
        .support-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .btn-support { padding: 12px; border-radius: 10px; text-decoration: none; font-weight: bold; font-size: 12px; color: white; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .btn-wa { background: rgba(37, 211, 102, 0.1); border: 1px solid var(--wa); color: var(--wa); box-shadow: 0 0 10px rgba(37, 211, 102, 0.2); }
        .btn-tg { background: rgba(0, 136, 204, 0.1); border: 1px solid var(--tg); color: var(--tg); box-shadow: 0 0 10px rgba(0, 136, 204, 0.2); }
        .btn-support:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

        .btn-download { background: linear-gradient(45deg, #ff0055, #ffcc00); color: black; padding: 10px 20px; border-radius: 50px; text-decoration: none; font-weight: bold; font-size: 12px; display: inline-block; margin-bottom: 20px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        .global-msg { background: rgba(255, 69, 0, 0.2); border: 1px solid var(--admin); padding: 10px; border-radius: 10px; margin-bottom: 15px; display: none; font-size: 13px; color: #fff; }
        input, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #222; background: #000; color: var(--neon); margin-bottom: 10px; box-sizing: border-box; text-align: center; }
        
        .signal-box { background: #000; border: 2px solid var(--neon); border-radius: 15px; padding: 25px; min-height: 140px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #sampleOdds, #sigVal { font-size: 60px; font-weight: 900; color: var(--neon); text-shadow: 0 0 15px var(--neon); margin: 0; }
        #sigVal { color: var(--win); text-shadow: 0 0 15px var(--win); }

        .f-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; border-radius: 15px; z-index: 100; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .stat-box { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; border: 1px solid #1a1e26; }

        .chart-container { height: 180px; width: 100%; margin-top: 10px; }
        .live-scroll { height: 30px; overflow: hidden; background: #000; border-radius: 5px; border: 1px solid #222; margin-top: 10px; font-size: 10px; line-height: 30px; color: var(--neon); }

        #adminPanel { display: none; background: #000; border: 2px dashed var(--admin); padding: 20px; border-radius: 15px; margin-top: 20px; text-align: left; }
        .admin-btn { background: var(--admin); color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; margin-top: 5px; width: 100%; font-weight: bold; }
    </style>
</head>
<body>

    <h1 style="color:var(--neon);">NEXUS AI <span style="color:var(--vip);">V15.2</span></h1>
    
    <div id="displayMsg" class="global-msg"></div>

    <div class="support-grid" style="max-width:500px; margin: 0 auto 15px auto;">
        <a href="https://wa.me/94762664220" class="btn-support btn-wa" target="_blank">üü¢ GET VIP (WA)</a>
        <a href="https://t.me/your_telegram_id" class="btn-support btn-tg" target="_blank">üîµ CONTACT ADMIN</a>
    </div>

    <a href="#" class="btn-download" onclick="alert('Starting Download...')">‚¨áÔ∏è DOWNLOAD ANDROID APP</a>

    <div style="max-width:500px; margin:auto;">
        
        <div class="stat-grid">
            <div class="stat-box">Users Online: <b id="uOnline" style="color:var(--neon);">0</b></div>
            <div class="stat-box">Win Rate: <b id="wRate" style="color:var(--win);">94.2%</b></div>
        </div>

        <div class="live-scroll" id="liveFeeder">Analyzing global server data...</div>

        <div class="card">
            <div class="f-overlay" id="fOverlay">
                <h3 style="margin-bottom:15px;">CONFIRM RESULT</h3>
                <button class="btn-prime" style="background:var(--win); color:black;" onclick="submitRes('win')">WIN ‚úÖ</button>
                <button class="btn-prime" style="background:var(--loss);" onclick="submitRes('loss')">LOSS ‚ùå</button>
            </div>

            <div class="signal-box">
                <div id="sampleArea">
                    <p id="sampleOdds">1.00x</p>
                    <p style="font-size:10px; color:var(--loss);">SAMPLE DATA</p>
                </div>
                <div id="realSigArea" style="display:none;">
                    <p id="sigVal">---</p>
                    <p style="font-size:12px; color:var(--win);" id="sigMsg">AI ANALYSIS ACTIVE</p>
                </div>
            </div>

            <div id="lockUI">
                <p style="font-size:11px; color:#666; margin-top:10px;">ADD 10 PASS ROUND AND UNLOCK 01 FREE SIGNAL</p>
                <input type="text" id="vKey" placeholder="ENTER VIP KEY">
                <button class="btn-prime" onclick="verifyKey()">ACTIVATE VIP</button>
                <p onclick="openAdmin()" style="font-size: 10px; margin-top: 20px; color: #333; cursor: pointer;">ADMIN ACCESS</p>
            </div>

            <div id="unlockUI" style="display:none;">
                <p id="sLeft" style="color:var(--vip); font-weight:bold;">Signals: 0</p>
                <button class="btn-prime" id="genBtn" onclick="genSig()">GENERATE SIGNAL</button>
            </div>
        </div>

        <div class="card">
            <h3 style="font-size: 12px; margin: 0;">SIGNAL ACCURACY CHART</h3>
            <div class="chart-container"><canvas id="winChart"></canvas></div>
            <div class="stat-grid" style="font-size: 11px;">
                <div style="color:var(--win)">Wins: <span id="tWinCount">0</span></div>
                <div style="color:var(--loss)">Loss: <span id="tLossCount">0</span></div>
            </div>
        </div>

        <div class="card">
            <h3>SIGNAL MINING</h3>
            <div style="display:flex; gap:5px; margin-bottom:10px;">
                <button class="admin-btn" style="background:#111; margin:0;" onclick="setPlatform('1XBET')">1XBET</button>
                <button class="admin-btn" style="background:#111; margin:0;" onclick="setPlatform('OTHERS')">OTHERS</button>
            </div>
            <input type="text" id="mInput" placeholder="Add Odds (Ex: 1.25, 4.20, 1.10)">
            <button class="btn-prime" style="background:var(--pink);" onclick="mine()">ADD MINING DATA</button>
            <p style="margin-top:10px; font-size:12px;">Total Added: <span id="tRounds" style="color:var(--neon);">0</span></p>
        </div>

        <div class="card" style="border: 1px solid var(--neon);">
            <h3>MONEY MANAGEMENT</h3>
            <input type="number" id="capitalInput" placeholder="ENTER YOUR CAPITAL" oninput="calculateBets()">
            <div class="stat-grid">
                <div class="stat-box">
                    <p style="font-size: 10px; color: var(--win); margin:0;">BET 01 (5%)</p>
                    <h2 id="bet1Display" style="margin:5px 0; font-size:20px;">0.00</h2>
                </div>
                <div class="stat-box">
                    <p style="font-size: 10px; color: var(--pink); margin:0;">BET 02 (2%)</p>
                    <h2 id="bet2Display" style="margin:5px 0; font-size:20px;">0.00</h2>
                </div>
            </div>
        </div>

        <div id="adminPanel" class="card">
            <h3 style="color:var(--admin); font-size: 14px;">üõ†Ô∏è ADMIN CONTROL</h3>
            <input type="text" id="adminMsg" placeholder="Broadcast Message">
            <button class="admin-btn" onclick="updateGlobalMsg()">UPDATE MESSAGE</button>
            <p style="font-size: 12px; margin-top: 15px;">üîë Key Gen:</p>
            <select id="keyDuration"><option value="1">1 Day</option><option value="7">7 Days</option><option value="30">30 Days</option></select>
            <button class="admin-btn" onclick="generateKey()">GENERATE KEY</button>
            <div id="newKeyOut" style="font-size: 12px; color: var(--vip); margin-top: 5px;"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD940gcjyowMQhMerqOPcFHIGahCybMxPM",
            authDomain: "nexus-ai-a5dd7.firebaseapp.com",
            databaseURL: "https://nexus-ai-a5dd7-default-rtdb.firebaseio.com",
            projectId: "nexus-ai-a5dd7",
            storageBucket: "nexus-ai-a5dd7.firebasestorage.app",
            messagingSenderId: "754990038696",
            appId: "1:754990038696:web:45b40bc9d02e890e8a0c9d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let rounds = 0; let free = 0; let vip = false;
        let history = []; let platform = "1XBET";
        const samples = ["1.50x", "4.20x", "8.90x", "2.10x", "12.4x", "1.10x"];
        let sIdx = 0;

        // --- üü¢ REAL USER TRACKING ---
        let userRef = db.ref('presence/' + Math.random().toString(36).substr(2, 9));
        userRef.set(true);
        userRef.onDisconnect().remove();

        db.ref('presence').on('value', s => {
            document.getElementById('uOnline').innerText = s.numChildren();
        });

        // --- üü¢ REAL WIN RATE TRACKING ---
        let totalWin = 0, totalLoss = 0;
        db.ref('stats').on('value', s => {
            let data = s.val() || {win: 0, loss: 0};
            totalWin = data.win; totalLoss = data.loss;
            document.getElementById('tWinCount').innerText = totalWin;
            document.getElementById('tLossCount').innerText = totalLoss;
            let rate = totalWin + totalLoss > 0 ? (totalWin / (totalWin + totalLoss) * 100).toFixed(1) : 0;
            document.getElementById('wRate').innerText = rate + "%";
        });

        // --- üü¢ UI INITIALIZATION ---
        const ctx = document.getElementById('winChart').getContext('2d');
        const winChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['10:00', '10:10', '10:20', '10:30', '10:40', '10:50'],
                datasets: [{
                    data: [92, 95, 88, 94, 96, 94],
                    borderColor: '#00f2ff',
                    backgroundColor: 'rgba(0, 242, 255, 0.1)',
                    borderWidth: 2,
                    fill: true, tension: 0.4
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { grid: { color: '#111' } } } }
        });

        setInterval(() => {
            const el = document.getElementById('sampleOdds');
            if(el && document.getElementById('sampleArea').style.display !== 'none') {
                el.innerText = samples[sIdx]; sIdx = (sIdx + 1) % samples.length;
            }
        }, 1000);

        // --- üü¢ DATA MINING & ANALYSIS ---
        function setPlatform(p) { platform = p; showLiveStatus("Platform: " + p); }

        function mine() {
            let input = document.getElementById('mInput');
            let oddValue = parseFloat(input.value);
            let timestamp = new Date().getTime();

            if (isNaN(oddValue)) { alert("Enter valid odd!"); return; }

            let entry = { odd: oddValue, time: timestamp, platform: platform };
            history.push(entry);
            let twentyMinsAgo = timestamp - (20 * 60 * 1000);
            history = history.filter(h => h.time > twentyMinsAgo);

            let bucket = Math.floor(timestamp / (3 * 60 * 1000)); 
            db.ref(`lifetime_data/${platform}/${bucket}`).push(entry);

            rounds++;
            document.getElementById('tRounds').innerText = rounds;
            free = Math.floor(rounds / 10);
            updateUnlockState();
            input.value = "";
            showLiveStatus("Data Analyzed for " + platform);
        }

        // --- üü¢ SMART SIGNAL GENERATION ---
        function genSig() {
            if (!vip && free <= 0) { alert("Add More Data!"); return; }

            document.getElementById('sampleArea').style.display = 'none';
            document.getElementById('realSigArea').style.display = 'block';
            let valEl = document.getElementById('sigVal');
            let msgEl = document.getElementById('sigMsg');

            let lowOdds = history.filter(h => h.odd < 2).length;
            let highOdds = history.filter(h => h.odd >= 2).length;
            let superOdds = history.find(h => h.odd >= 35);
            let ultraOdds = history.find(h => h.odd >= 50);

            let resultOdd = "WAIT";
            let statusColor = "var(--vip)";
            let msg = "ANALYZING MARKET...";

            if (history.length < 5) {
                msg = "TRY TO NEXT AFTER THE ADD DATA";
                resultOdd = "LOW DATA"; 
                statusColor = "gray"; 
                valEl.innerText = resultOdd;
                msgEl.innerText = msg;
                valEl.style.color = statusColor;
                msgEl.style.color = statusColor;
                valEl.style.fontSize = "35px";
                
                setTimeout(() => {
                    document.getElementById('realSigArea').style.display = 'none';
                    document.getElementById('sampleArea').style
